mean_line_color = 'black'
box_line_size = 0.75/(ggplot2::.pt*72.27/96)
set_conjugation_rate_linetype = 'dashed'
basecase_color= c(rgb(169, 169, 169, maxColorValue = 255))
basecase_color_fill = c(rgb(221, 221, 221, maxColorValue = 255))
set_conjugation_rate_color = c(rgb(169, 169, 169, maxColorValue = 255))
set_conjugation_rate_line_size = 0.75/(ggplot2::.pt*72.27/96)
outlier_point_size = 0
outlier_shape = 19
percentage_filter = 0.9
# Plot customization -------------------------------------------------
tauD_x_axis_label = expression(paste("Transconjugant conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
growth_mean_line_length = 0.69
# Treatment data -------------------------------------------------
treatment_description <- read.csv("Treatments_master.csv", header = TRUE)
# tauD sweep data -------------------------------------------------
csvfiles <- list.files("data/tauD", full.names = TRUE)
csvfileslist <- lapply(csvfiles, read.csv, header = TRUE, stringsAsFactors = FALSE)
treatments <- strsplit(csvfiles,"/")
treatment_names <- rep(NA, length(treatments))
for (i in 1:length(treatments)){
filename <- treatments[[i]][length(treatments[[i]])]
treatment_names[i] <- strsplit(filename,'_')[[1]][1]
}
# tauD sweep data -------------------------------------------------
csvfiles <- list.files("data/tauD", full.names = TRUE)
csvfiles
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
theme_set(theme_cowplot())
#remotes::install_github("wilkelab/ungeviz")
library(ungeviz)
library(scales)
# Plot filtering ----------------------------------------------------------
Set_conjugation_rate = 1e-6 # The simulated conjugation rate
estimate_labels <- c("LDM", "SIM", "TDR", "ASM")
select_estimates <- c("LDM", "SIM", "TDR", "ASM")
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
margin_left = 0.2
margin_right = 0.2
margin_y_axis = 0.2
margin_top = 0.2
margin_bottom = 0.2
margins_top <- c(margin_top, margin_right, margin_bottom, margin_left)
margins_bottom<- c(margin_top, margin_right, margin_bottom, margin_left)
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
plot_height = plot_width/4
Figure_height = plot_height + (margin_top*2) + (margin_bottom*2)
Figure_label_size = 10
text_size_axis_title = 8
text_size_axis_tick_labels = 8
axis_line_size = 0.75/(ggplot2::.pt*72.27/96) # pt size for the axis lines
axis_tick_size = 0.75/(ggplot2::.pt*72.27/96)
axis_tick_lengths = 0.03
y_axis_min = 1e-8
y_axis_max = 1e-4
y_axis_number_of_ticks = 4
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
color = c('tan4', c(rgb(205, 102, 0, maxColorValue = 255)), c(rgb(0, 139, 139, maxColorValue = 255)), c(rgb(85, 107, 47, maxColorValue = 255))) #tan4, darkorange3, green, cyan
color_fill = c(c(rgb(226, 210, 195, maxColorValue = 255)), c(rgb(255, 229, 204, maxColorValue = 255)), c(rgb(205, 249, 247, maxColorValue = 255)), c(rgb(211, 216, 175, maxColorValue = 255))) #light tan and light orange
# Box plot customization -------------------------------------------------
mean_line_size = 0.75/(ggplot2::.pt*72.27/96)
mean_line_color = 'black'
box_line_size = 0.75/(ggplot2::.pt*72.27/96)
set_conjugation_rate_linetype = 'dashed'
basecase_color= c(rgb(169, 169, 169, maxColorValue = 255))
basecase_color_fill = c(rgb(221, 221, 221, maxColorValue = 255))
set_conjugation_rate_color = c(rgb(169, 169, 169, maxColorValue = 255))
set_conjugation_rate_line_size = 0.75/(ggplot2::.pt*72.27/96)
outlier_point_size = 0
outlier_shape = 19
percentage_filter = 0.9
# Plot customization -------------------------------------------------
gammaT_x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
growth_mean_line_length = 0.69
# Treatment data -------------------------------------------------
treatment_description <- read.csv("Treatments_master.csv", header = TRUE)
# gammaT sweep data -------------------------------------------------
csvfiles <- list.files("data/gammaT", full.names = TRUE)
csvfileslist <- lapply(csvfiles, read.csv, header = TRUE, stringsAsFactors = FALSE)
treatments <- strsplit(csvfiles,"/")
treatment_names <- rep(NA, length(treatments))
for (i in 1:length(treatments)){
filename <- treatments[[i]][length(treatments[[i]])]
treatment_names[i] <- strsplit(filename,'_')[[1]][1]
}
meantable = data.frame()
for (l in 1:length(csvfileslist)) {
csvfileslist[[l]] <- csvfileslist[[l]][-1,]
csvfileslist[[l]] <- subset(csvfileslist[[l]], select = select_estimates)
if ((sum(csvfileslist[[l]]['SIM'] > 0)/nrow(csvfileslist[[l]]['SIM'])) < percentage_filter) {
csvfileslist[[l]]['SIM'] <- rep(0, times = nrow(csvfileslist[[l]]['SIM']))
csvfileslist[[l]]['TDR'] <- rep(0, times = nrow(csvfileslist[[l]]['SIM']))
csvfileslist[[l]]['ASM'] <- rep(0, times = nrow(csvfileslist[[l]]['SIM']))
}
csvfileslist[[l]]['gammaT'] <- rep(treatment_description['gammaTR'][treatment_description['Treatment_ID'] == treatment_names[l]], nrow(csvfileslist[[l]]))
csvfileslist[[l]] <- pivot_longer(csvfileslist[[l]], cols=select_estimates , names_to = "estimate", values_to = "conjugationestimate")
meanlist <- aggregate(csvfileslist[[l]]$conjugationestimate ~ csvfileslist[[l]]$estimate, FUN = mean)
colnames(meanlist) <- c("estimate", "conjugationestimate")
meanlist['gammaT'] <- rep(treatment_description['gammaTR'][treatment_description['Treatment_ID'] == treatment_names[l]], nrow(meanlist))
meantable <- rbind(meantable, meanlist)
}
gammaT_frame <- bind_rows(csvfileslist)
gammaT_frame$estimate <- factor(gammaT_frame$estimate , levels=select_estimates, ordered = TRUE, labels = estimate_labels)
meantable$estimate <- factor(meantable$estimate, levels=select_estimates, ordered = TRUE, labels = estimate_labels)
# gammaT sweep plot -------------------------------------------------
gammaT <- ggplot(gammaT_frame %>% filter(gammaT != 1e-6), aes(x=gammaT, y=conjugationestimate, group = interaction(gammaT, estimate), fill = estimate))+
geom_hline(yintercept = Set_conjugation_rate, linetype = set_conjugation_rate_linetype, color = set_conjugation_rate_color, size = set_conjugation_rate_line_size)+
geom_boxplot(data = gammaT_frame, aes(x=gammaT, y=conjugationestimate, group = interaction(gammaT, estimate)),
color = basecase_color, fill = basecase_color_fill, notch=FALSE, size = box_line_size, outlier.shape = outlier_shape, outlier.size = outlier_point_size, outlier.alpha = 0.25)+
geom_boxplot(notch=FALSE, aes(colour = estimate), size = box_line_size, outlier.shape = outlier_shape, outlier.size = outlier_point_size, outlier.alpha = 0.25)+
geom_hpline(data = meantable, color = mean_line_color, size = mean_line_size, width = growth_mean_line_length)+
xlab(gammaT_x_axis_label)+
theme(axis.title.y = element_blank())+
theme(axis.title = element_text(size = text_size_axis_title)) +
theme(axis.line.y = element_line(size = axis_line_size)) +
theme(axis.line.x = element_line(size = axis_line_size)) +
theme(axis.ticks = element_line(size = axis_tick_size))+
theme(axis.ticks.length = unit(axis_tick_lengths, 'in'))+
theme(axis.text = element_text(size = text_size_axis_tick_labels))+
theme(legend.position = "none") +
theme(plot.margin = unit(margins_top, "in"))+
facet_grid(~estimate)+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x), labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(limits = c(y_axis_min, y_axis_max), breaks = trans_breaks("log10", function(x) 10^x, n = y_axis_number_of_ticks), labels = trans_format("log10", math_format(10^.x)))+
scale_fill_manual(values = color_fill)+
scale_color_manual(values = color, guide = "none")+
theme(strip.background = element_blank())+
theme(strip.text = element_blank())
gammaT
# Assemble plot -------------------------------------------------
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaT), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
plot_height = plot_width/2
Figure_height = 4
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
Figure_height = 4
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
Figure_height = 4
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
gammaTR
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
Figure_height = 4
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
gammaTR
# Assemble plot -------------------------------------------------
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaT), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
Figure_height = 3
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
Figure
Figure <- grid.arrange(y.grob, as_grob(gammaT), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
gammaTR
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
Figure_height = 3
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
gammaTR
# Assemble plot -------------------------------------------------
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
Figure_height = 2.7
# Assemble plot -------------------------------------------------
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
(plot_width + margin_right + margin_left)
margin_y_axis
# Assemble plot -------------------------------------------------
Fig <- (gammaTR) +
plot_annotation(tag_levels = list(c(''))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(0.1, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(0.05, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
plot_width
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
Figure_height = 2.7
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
gammaTR
# Assemble plot -------------------------------------------------
Fig <- (gammaTR) +
plot_annotation(tag_levels = list(c(''))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
gammaTR <- Box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
# Assemble plot -------------------------------------------------
Fig <- (gammaTR) +
plot_annotation(tag_levels = list(c(''))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(gammaTR), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 2.5
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
# Assemble plot -------------------------------------------------
Fig <- (gammaTR) +
plot_annotation(tag_levels = list(c(''))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 2.5
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
# Assemble plot -------------------------------------------------
Fig <- (gammaTR) +
plot_annotation(tag_levels = list(c(''))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 2.5
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# gammaTR sweep data -------------------------------------------------
gammaTR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/gammaTR",
new_zero_value = 1e-8,
parameter_for_xaxis_values = 'gammaTR')
gammaTR <- Gamma_box_plot(sim_data_frame = gammaTR_frame,
mean_dataframe = gammaTR_mean_frame,
x_axis_label = expression(paste("Transconjugant conjugation rate (ml ", 'cfu'^-1, ' hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-8,
y_axis_max = 1e-2)
# Assemble plot -------------------------------------------------
Fig <- (gammaTR) +
plot_annotation(tag_levels = list(c(''))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig3.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
