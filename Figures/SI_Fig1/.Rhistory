facet_grid(~estimate)+
scale_x_log10()+
scale_y_log10(limits = c(y_axis_min, y_axis_max), breaks = trans_breaks("log10", function(x) 10^x, n = y_axis_number_of_ticks), labels = trans_format("log10", math_format(10^.x)))+
scale_fill_manual(values = color_fill)+
scale_color_manual(values = color, guide = "none")
ggplot(psiD_frame, aes(x = psiD, y = conjugationestimate, group = interaction(psiD, estimate), fill = estimate))+
geom_boxplot()+
facet_grid(~estimate)+
theme(strip.background = F)
ggplot(psiD_frame, aes(x = psiD, y = conjugationestimate, group = interaction(psiD, estimate), fill = estimate))+
geom_boxplot()+
facet_grid(~estimate)+
theme(strip.background = element_blank())
ggplot(psiD_frame, aes(x = psiD, y = conjugationestimate, group = interaction(psiD, estimate), fill = estimate))+
geom_boxplot()+
facet_grid(~estimate)+
theme(strip.background = element_blank())+
theme(strip.text = element_text(size = 8))
ggplot(psiD_frame, aes(x = psiD, y = conjugationestimate, group = interaction(psiD, estimate), fill = estimate))+
geom_boxplot()+
facet_grid(~estimate)+
theme(strip.background = element_blank())+
theme(strip.text = element_text(size = 8, color = c('red', 'black', 'red', 'black')))
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = (Figure_width/4)*2 + margin_y_axis*6
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiD
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipient and transconjugant growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiR
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1.1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = (Figure_width/3)*2
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiD
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiR
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1.1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
Figure_height
(Figure_width/3)*2
(Figure_width/2)*2
(Figure_width/3)*3
Figure_width
Figure_height = 5
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = 7)
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = 5
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiD
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiR
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = 5
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiD
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
psiR
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("Fig.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = 5
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig1.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = 5
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig1.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = 5
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig1.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
Figure_height = 5
# Plasmid effect sweep data -------------------------------------------------
psiD_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiD",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiD')
psiD <- Box_plot(sim_data_frame = psiD_frame,
mean_dataframe = psiD_mean_frame,
x_axis_label = expression(paste("Plasmid-containing cells growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Host effect sweep data -------------------------------------------------
psiR_frame <- Parameter_sweep_load_data(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR_mean_frame <- Parameter_sweep_mean_calculation(treatments_filename = "Treatments_master.csv",
simulation_estimates_folder = "data/psiR",
new_zero_value = 1e-9,
parameter_for_xaxis_values = 'psiR')
psiR <- Box_plot(sim_data_frame = psiR_frame,
mean_dataframe = psiR_mean_frame,
x_axis_label = expression(paste("Recipients and transconjugants growth rate (", 'hr'^-1, ")")),
Set_conjugation_rate = 1e-6,
y_axis_min = 1e-9,
y_axis_max = 1e-4)
# Assemble plot -------------------------------------------------
Fig <- (psiD/ psiR) +
plot_annotation(tag_levels = list(c('a', 'b'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig1.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
