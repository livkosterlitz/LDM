set_conjugation_rate_color = c(rgb(169, 169, 169, maxColorValue = 255)),
set_conjugation_rate_line_size = 0.75/(ggplot2::.pt*72.27/96),
basecase_color= c(rgb(169, 169, 169, maxColorValue = 255)),
basecase_color_fill = c(rgb(221, 221, 221, maxColorValue = 255)),
box_line_size = 0.75/(ggplot2::.pt*72.27/96) ,
outlier_shape = 19,
outlier_point_size = 0,
mean_dataframe,
mean_line_color = 'black',
mean_line_size = 0.75/(ggplot2::.pt*72.27/96),
mean_line_length = 0.15,
parameter_xaxis_x_axis_label,
text_size_axis_title = 8,
axis_line_size = 0.75/(ggplot2::.pt*72.27/96),
axis_tick_size = 0.75/(ggplot2::.pt*72.27/96),
axis_tick_lengths = 0.03,
text_size_axis_tick_labels = 8,
margins = c(0.1, 0.2, 0.1, 0.2),
x_axis_label,
y_axis_min,
y_axis_max,
x_axis_min = 0,
x_axis_max = 9,
x_axis_breaks = c(0,3,6,9),
y_axis_number_of_ticks = 4,
color_fill = c(c(rgb(226, 210, 195, maxColorValue = 255)), c(rgb(255, 229, 204, maxColorValue = 255)), c(rgb(205, 249, 247, maxColorValue = 255)), c(rgb(211, 216, 175, maxColorValue = 255))), #light tan and light orange
color = c('tan4', c(rgb(205, 102, 0, maxColorValue = 255)), c(rgb(0, 139, 139, maxColorValue = 255)), c(rgb(85, 107, 47, maxColorValue = 255)))) #tan4, darkorange3, green, cyan)
{p <- ggplot(sim_data_frame, aes(x=time, y=conjugationestimate, group = interaction(time, estimate), color = estimate, fill = estimate)) +
geom_hline(yintercept = Set_conjugation_rate, linetype = set_conjugation_rate_linetype, color = set_conjugation_rate_color, size = set_conjugation_rate_line_size)+
geom_boxplot(notch=FALSE, size = box_line_size, outlier.shape = outlier_shape, outlier.size = outlier_point_size, outlier.alpha = 0.25)+
geom_hpline(data = mean_dataframe, color = mean_line_color, size = mean_line_size, width = mean_line_length)+
scale_x_continuous(limits = c(x_axis_min, x_axis_max), breaks = x_axis_breaks)+
scale_y_log10(limits=c(y_axis_min, y_axis_max), breaks = scales::trans_breaks("log10", function(x) 10^x, n = y_axis_number_of_ticks), labels = scales::trans_format("log10", scales::math_format(10^.x))) +
theme(axis.title.y = element_blank())+
theme(axis.title.x = element_blank())+
facet_grid(~estimate)+
theme(axis.title = element_text(size = text_size_axis_title)) +
theme(axis.line.y = element_line(size = axis_line_size)) +
theme(axis.line.x = element_line(size = axis_line_size)) +
theme(axis.ticks = element_line(size = axis_tick_size))+
theme(axis.ticks.length = unit(axis_tick_lengths, 'in'))+
theme(axis.text = element_text(size = text_size_axis_tick_labels))+
theme(legend.position = "none") +
theme(plot.margin = unit(margins, "in"))+
scale_fill_manual(values = color_fill)+
scale_color_manual(values = color, guide = "none")+
theme(strip.background = element_blank())+
theme(strip.text = element_text(size = text_size_axis_tick_labels))
return(p)
}
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.75)
basecase
Time_box_plot <- function(sim_data_frame,
Set_conjugation_rate,
set_conjugation_rate_linetype = 'dashed',
set_conjugation_rate_color = c(rgb(169, 169, 169, maxColorValue = 255)),
set_conjugation_rate_line_size = 0.75/(ggplot2::.pt*72.27/96),
basecase_color= c(rgb(169, 169, 169, maxColorValue = 255)),
basecase_color_fill = c(rgb(221, 221, 221, maxColorValue = 255)),
box_line_size = 0.75/(ggplot2::.pt*72.27/96) ,
outlier_shape = 19,
outlier_point_size = 0,
mean_dataframe,
mean_line_color = 'black',
mean_line_size = 0.75/(ggplot2::.pt*72.27/96),
mean_line_length = 0.08,
parameter_xaxis_x_axis_label,
text_size_axis_title = 8,
axis_line_size = 0.75/(ggplot2::.pt*72.27/96),
axis_tick_size = 0.75/(ggplot2::.pt*72.27/96),
axis_tick_lengths = 0.03,
text_size_axis_tick_labels = 8,
margins = c(0.1, 0.2, 0.1, 0.2),
x_axis_label,
y_axis_min,
y_axis_max,
x_axis_min = 0,
x_axis_max = 9,
x_axis_breaks = c(0,3,6,9),
y_axis_number_of_ticks = 4,
color_fill = c(c(rgb(226, 210, 195, maxColorValue = 255)), c(rgb(255, 229, 204, maxColorValue = 255)), c(rgb(205, 249, 247, maxColorValue = 255)), c(rgb(211, 216, 175, maxColorValue = 255))), #light tan and light orange
color = c('tan4', c(rgb(205, 102, 0, maxColorValue = 255)), c(rgb(0, 139, 139, maxColorValue = 255)), c(rgb(85, 107, 47, maxColorValue = 255)))) #tan4, darkorange3, green, cyan)
{p <- ggplot(sim_data_frame, aes(x=time, y=conjugationestimate, group = interaction(time, estimate), color = estimate, fill = estimate)) +
geom_hline(yintercept = Set_conjugation_rate, linetype = set_conjugation_rate_linetype, color = set_conjugation_rate_color, size = set_conjugation_rate_line_size)+
geom_boxplot(notch=FALSE, size = box_line_size, outlier.shape = outlier_shape, outlier.size = outlier_point_size, outlier.alpha = 0.25)+
geom_hpline(data = mean_dataframe, color = mean_line_color, size = mean_line_size, width = mean_line_length)+
scale_x_continuous(limits = c(x_axis_min, x_axis_max), breaks = x_axis_breaks)+
scale_y_log10(limits=c(y_axis_min, y_axis_max), breaks = scales::trans_breaks("log10", function(x) 10^x, n = y_axis_number_of_ticks), labels = scales::trans_format("log10", scales::math_format(10^.x))) +
theme(axis.title.y = element_blank())+
theme(axis.title.x = element_blank())+
facet_grid(~estimate)+
theme(axis.title = element_text(size = text_size_axis_title)) +
theme(axis.line.y = element_line(size = axis_line_size)) +
theme(axis.line.x = element_line(size = axis_line_size)) +
theme(axis.ticks = element_line(size = axis_tick_size))+
theme(axis.ticks.length = unit(axis_tick_lengths, 'in'))+
theme(axis.text = element_text(size = text_size_axis_tick_labels))+
theme(legend.position = "none") +
theme(plot.margin = unit(margins, "in"))+
scale_fill_manual(values = color_fill)+
scale_color_manual(values = color, guide = "none")+
theme(strip.background = element_blank())+
theme(strip.text = element_text(size = text_size_axis_tick_labels))
return(p)
}
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.75)
basecase
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.21)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.21)
basecase
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
basecase
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 9
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
text_size_axis_title = 8
# basecase estimates  --------------------------------------------
basecase_frame <- Time_sweep_load_data(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase_mean <- Time_sweep_mean_calculation(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
basecase
plasmid_effects_frame <- Time_sweep_load_data(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
plasmid_effects
plasmid_effects_frame <- Time_sweep_load_data(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects_frame <- Time_sweep_load_data(treatments_filename = "data/host_effects",
zero_value = 1e-16)
plasmid_effects <- Time_box_plot(sim_data_frame = plasmid_effects_frame,
mean_dataframe = plasmid_effects_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
plasmid_effects
plasmid_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects_frame <- Time_sweep_load_data(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects <- Time_box_plot(sim_data_frame = plasmid_effects_frame,
mean_dataframe = plasmid_effects_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
plasmid_effects
host_effects_frame <- Time_sweep_load_data(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects <- Time_box_plot(sim_data_frame = host_effects_frame,
mean_dataframe = host_effects_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
host_effects
# gammaT estimates  --------------------------------------------
gammaT_frame <- Time_sweep_load_data(treatments_filename = "data/gammaT",
zero_value = 1e-16)
gammaT_mean <- Time_sweep_mean_calculation(treatments_filename = "data/gammaT",
zero_value = 1e-16)
gammaT <- Time_box_plot(sim_data_frame = gammaT_frame,
mean_dataframe = gammaT_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
gammaT
# tau estimates  --------------------------------------------
tau_frame <- Time_sweep_load_data(treatments_filename = "data/tau",
zero_value = 1e-16)
tau_mean <- Time_sweep_mean_calculation(treatments_filename = "data/tau",
zero_value = 1e-16)
tau <- Time_box_plot(sim_data_frame = tau_frame,
mean_dataframe = tau_mean,
x_axis_label = "Time (hr)",
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# Fig assemble  ------------------------------------------------------------
Fig <- (basecase/ plasmid_effects/ host_effects/ gammaT/ tau) +
plot_annotation(tag_levels = list(c('a', 'b', 'c', 'd', 'e'))) &
theme(plot.tag.position = c(0, 1.1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig5.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
# Fig assemble  ------------------------------------------------------------
Fig <- (basecase/ plasmid_effects/ host_effects/ gammaT/ tau) +
plot_annotation(tag_levels = list(c('a', 'b', 'c', 'd', 'e'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
save_plot("SI_Fig5.pdf", plot = Figure, base_width = Figure_width, base_height = Figure_height)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
x_axis_label = expression("Time (hr)")
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
x.grob <- textGrob(x_axis_label, gp=gpar(fontsize=text_size_axis_title))
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
margin_x_axis = 0.2
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
Figure2 <- grid.arrange(as_grob(Figure), x.grob, nrow = 2, heights = unit(c(Figure_height-margin_x_axis, margin_x_axis), c('in', 'in')))
save_plot("SI_Fig5.pdf", plot = Figure2, base_width = Figure_width, base_height = Figure_height)
margin_x_axis = 0.1
Figure2 <- grid.arrange(as_grob(Figure), x.grob, nrow = 2, heights = unit(c(Figure_height-margin_x_axis, margin_x_axis), c('in', 'in')))
save_plot("SI_Fig5.pdf", plot = Figure2, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 9
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
margin_x_axis = 0.1
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
x_axis_label = expression("Time (hr)")
text_size_axis_title = 8
# basecase estimates  --------------------------------------------
basecase_frame <- Time_sweep_load_data(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase_mean <- Time_sweep_mean_calculation(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# plasmid_effects estimates  --------------------------------------------
plasmid_effects_frame <- Time_sweep_load_data(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects <- Time_box_plot(sim_data_frame = plasmid_effects_frame,
mean_dataframe = plasmid_effects_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# host_effects estimates  --------------------------------------------
host_effects_frame <- Time_sweep_load_data(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects <- Time_box_plot(sim_data_frame = host_effects_frame,
mean_dataframe = host_effects_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# gammaT estimates  --------------------------------------------
gammaT_frame <- Time_sweep_load_data(treatments_filename = "data/gammaT",
zero_value = 1e-16)
gammaT_mean <- Time_sweep_mean_calculation(treatments_filename = "data/gammaT",
zero_value = 1e-16)
gammaT <- Time_box_plot(sim_data_frame = gammaT_frame,
mean_dataframe = gammaT_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# tau estimates  --------------------------------------------
tau_frame <- Time_sweep_load_data(treatments_filename = "data/tau",
zero_value = 1e-16)
tau_mean <- Time_sweep_mean_calculation(treatments_filename = "data/tau",
zero_value = 1e-16)
tau <- Time_box_plot(sim_data_frame = tau_frame,
mean_dataframe = tau_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# Fig assemble  ------------------------------------------------------------
Fig <- (basecase/ plasmid_effects/ host_effects/ gammaT/ tau) +
plot_annotation(tag_levels = list(c('a', 'b', 'c', 'd', 'e'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
x.grob <- textGrob(x_axis_label, gp=gpar(fontsize=text_size_axis_title))
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
Figure2 <- grid.arrange(as_grob(Figure), x.grob, nrow = 2, heights = unit(c(Figure_height-margin_x_axis, margin_x_axis), c('in', 'in')))
save_plot("SI_Fig5.pdf", plot = Figure2, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 9
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
margin_x_axis = 0.1
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
x_axis_label = expression("Time (hr)")
text_size_axis_title = 8
# basecase estimates  --------------------------------------------
basecase_frame <- Time_sweep_load_data(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase_mean <- Time_sweep_mean_calculation(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# plasmid_effects estimates  --------------------------------------------
plasmid_effects_frame <- Time_sweep_load_data(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/plasmid_effects",
zero_value = 1e-16)
plasmid_effects <- Time_box_plot(sim_data_frame = plasmid_effects_frame,
mean_dataframe = plasmid_effects_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# host_effects estimates  --------------------------------------------
host_effects_frame <- Time_sweep_load_data(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects_mean <- Time_sweep_mean_calculation(treatments_filename = "data/host_effects",
zero_value = 1e-16)
host_effects <- Time_box_plot(sim_data_frame = host_effects_frame,
mean_dataframe = host_effects_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# gammaT estimates  --------------------------------------------
gammaT_frame <- Time_sweep_load_data(treatments_filename = "data/gammaT",
zero_value = 1e-16)
gammaT_mean <- Time_sweep_mean_calculation(treatments_filename = "data/gammaT",
zero_value = 1e-16)
gammaT <- Time_box_plot(sim_data_frame = gammaT_frame,
mean_dataframe = gammaT_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# tau estimates  --------------------------------------------
tau_frame <- Time_sweep_load_data(treatments_filename = "data/tau",
zero_value = 1e-16)
tau_mean <- Time_sweep_mean_calculation(treatments_filename = "data/tau",
zero_value = 1e-16)
tau <- Time_box_plot(sim_data_frame = tau_frame,
mean_dataframe = tau_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
# Fig assemble  ------------------------------------------------------------
Fig <- (basecase/ plasmid_effects/ host_effects/ gammaT/ tau) +
plot_annotation(tag_levels = list(c('a', 'b', 'c', 'd', 'e'))) &
theme(plot.tag.position = c(0, 1), plot.tag = element_text(size = Figure_label_size)) &
plot_layout(widths = unit(c(plot_width), c('in')))
y.grob <- textGrob(y_axis_label, gp=gpar(fontsize=text_size_axis_title), rot=90)
x.grob <- textGrob(x_axis_label, gp=gpar(fontsize=text_size_axis_title))
Figure <- grid.arrange(y.grob, as_grob(Fig), ncol = 2, widths = unit(c(margin_y_axis, (plot_width + margin_right + margin_left)), c('in', 'in')))
Figure2 <- grid.arrange(as_grob(Figure), x.grob, nrow = 2, heights = unit(c(Figure_height-margin_x_axis, margin_x_axis), c('in', 'in')))
save_plot("SI_Fig5.pdf", plot = Figure2, base_width = Figure_width, base_height = Figure_height)
# Packages ----------------------------------------------------------
library(tidyverse)
library(patchwork)
library(egg)
library(grid)
library(cowplot)
library(ungeviz)
library(devtools)
install.packages("devtools")
install.packages("gert")
library(cowplot)
#library(devtools)
#library(ungeviz)
library(scales)
source(file = "Simulation_functions_parameter_sweep.R")
theme_set(theme_cowplot())
# General plotting customization -------------------------------------------------
Figure_width = 7 # in width for one column figure in PNAS
Figure_height = 9
Figure_label_size = 10
margin_y_axis = 0.2
margin_right = 0.2
margin_left = 0.2
margin_x_axis = 0.1
plot_width = Figure_width - margin_right - margin_left - margin_y_axis
y_axis_label = expression(paste("Conjugation estimate (ml ", 'cfu'^-1, ' hr'^-1, ")"))
x_axis_label = expression("Time (hr)")
text_size_axis_title = 8
# basecase estimates  --------------------------------------------
basecase_frame <- Time_sweep_load_data(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase_mean <- Time_sweep_mean_calculation(treatments_filename = "data/basecase",
zero_value = 1e-16)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
devtools::install_github("hadley/devtools")
install.packages("devtools")
install.packages("devtools")
library(devtools)
library(ungeviz)
devtools::install_github("wilkelab/ungeviz")
#devtools::install_github("wilkelab/ungeviz")
library(ungeviz)
basecase <- Time_box_plot(sim_data_frame = basecase_frame,
mean_dataframe = basecase_mean,
Set_conjugation_rate = 1e-14,
y_axis_min = 1e-16,
y_axis_max = 1e-12,
mean_line_length = 0.4)
basecase
basecase
